# 設計書：打席ログ編集機能拡張

## 1. データ構造の変更

`js/data/constants.js` の `DEFAULT_STATE` に以下のフィールドを追加する。

```javascript
atBatLog: [];
```

各要素の構造：

```javascript
{
  id: string,         // ユニークID
  inning: number,     // イニング
  half: string,       // 'top' or 'bottom'
  team: string,       // 'away' or 'home'
  batterName: string, // 打者名
  batterIndex: number,// 打順（0-8）
  pitcherName: string,// 投手名
  result: string,     // 結果コード（'single', 'homerun' 等）
  rbi: number,        // 打点
  runs: number,       // 失点
  earnedRuns: number  // 自責点
}
```

## 2. 処理フロー

### 2.1 記録時 (app.js)

1. 打席結果ボタン（`data-result`）クリック時。
2. 既存の `rbi` 計算処理の後に、`atBatLog` オブジェクトを作成して `state.atBatLog.push()` する。
3. `runs` と `earnedRuns` は、スコアリングプレイであれば打点と同等、あるいは現在の得点増分から初期値を設定する。

### 2.2 UI表示 (admin-simple.html)

1. `tab-control` 内に `#at-bat-log-container` を追加。
2. `Render.updateDisplay` 内（または `app.js` の専用関数）で、`state.atBatLog` をループしてテーブル行を生成する。

### 2.3 編集・保存時 (app.js)

1. 編集用 UI（入力欄など）で値が変更されたら、対象の `atBatLog` エントリを更新する。
2. **再計算処理を実行**:
   - `state.todayRBI` を `atBatLog` から集計し直す。
   - `state.atBatResults` を `atBatLog` から構成し直す。
   - `state.pitcherStats` の失点（および必要なら自責点）を再集計する。
3. `updateAndSave()` を呼び出し、変更を永続化・同期する。

## 3. UIデザイン

- 狭い画面でも見やすいよう、テーブルのフォントサイズは小さめ（11px〜12px）にする。
- 結果はセレクトボックス、数値は narrow な input 欄で編集可能にする。
