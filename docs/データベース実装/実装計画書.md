# データベース実装計画書

## 概要

`admin-simple.html` からの入力データをデータベース（MySQL）に保存し、打率・OBS・防御率などの成績をリアルタイムに計算・表示するシステムを構築します。
また、チームや選手を管理するための専用ページ `admin-db.html` を新たに作成します。

## 変更内容

### 1. データベース (MySQL)

- `init.sql` を更新し、以下のテーブルを作成します。
  - `teams`: チーム情報
  - `players`: 選手情報
  - `games`: 試合情報
  - `at_bats`: 1打席ごとの結果（安打、四球、アウトなど詳細）
  - `pitching_stats`: 投手成績サマリー（イニング、自責点など）

### 2. バックエンド (Node.js API)

- `server.js` に以下の機能を追加します。
  - チーム・選手データのCRUD操作 (Create, Read, Update, Delete)
  - 打席結果の登録API (`POST /api/atbats`)
  - 成績集計API (`GET /api/stats/batter/:id`, `GET /api/stats/pitcher/:id`)

#### [x] [app.js](file:///c:/Users/jingt/dev/BaseballLive/js/app.js) - API integration

#### [x] [state.js](file:///c:/Users/jingt/dev/BaseballLive/js/data/state.js) - Master data storage

#### [x] [index.html](file:///c:/Users/jingt/dev/BaseballLive/index.html) - Stats display containers

#### [MODIFY] [render.js](file:///c:/Users/jingt/dev/BaseballLive/js/ui/render.js) - Stats display logic

## Verification Plan

### 3. フロントエンド

- **[新規] admin-db.html**:
  - チームと選手の登録・編集・削除を行う管理画面。
  - モダンなUIで、データベースの内容を直感的に操作可能にします。
- **admin-simple.html**:
  - `app.js` を改修し、ボタン押下時にAPIへデータを送信するようにします。
- **index.html**:
  - 成績表示部分をAPIから取得したデータで更新するようにします。

## 検証手順

1. `docker-compose up` でDBとAPIサーバーを起動。
2. `admin-db.html` を開き、チームと選手を登録。
3. `admin-simple.html` を開き、登録した選手を選択して打席結果を入力。
4. API経由でデータが保存されていることを確認。
5. `index.html` で成績計算（打率など）が正しいか確認。
