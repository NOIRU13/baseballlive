# リファクタリング要件定義

## 目的

現在の `script.js` は、データ定義、UI操作、ゲームロジック、通信処理などが混在した500行以上のモノリシックなファイルとなっている。これを機能ごとにモジュール分割し、可読性と保守性を向上させる。

## 対象ファイル

- `script.js`

## リファクタリング方針

1. **ESモジュールの導入**: `<script type="module">` を使用し、ブラウザネイティブのモジュール機能を利用する。
2. **機能分離**: 以下の責務ごとにファイルを分割する。
   - **State Management**: データの保持、読み書き、初期値。
   - **Game Logic**: 野球のルール（カウント、進塁、得点計算）、スタッツ計算。
   - **UI / DOM**: 画面の更新、要素の生成。
   - **Infrastructure / Sync**: API通信、BroadcastChannel、LocalStorage同期。
   - **Event Handlers**: ユーザー操作のイベントリスナー。
   - **Main**: アプリケーションの初期化と各モジュールの結合。

## 期待される効果

- コードの重複排除（特にState更新部分）。
- 特定機能の修正が他へ影響しにくくなる。
- 可読性の向上。

## 制約事項

- 既存の `index.html`, `admin.html` などのHTMLファイルで `script.js` を読み込んでいる部分を書き換える必要がある。
- `http-server` 上で動作するため、ESモジュールは問題なく動作するはず（CORS/MIMEタイプ等の問題はないと仮定）。
